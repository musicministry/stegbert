% ------------------------------------------------------------------------------------------------------ %
% PACKAGES
\usepackage{bbding}      % Cross symbol
\usepackage{datetime}   % Custom date format
\usepackage{hyperref}   % Hyperlinke support
\usepackage{pgfkeys}    % Support for key-value dictionary-like pairs 
\usepackage{xcolor}       % Text color
\usepackage[margin=1 in]{geometry}

% ========================================================== %
% COMMANDS AND CONFIGURATIONS

% Increase line spacing
\linespread{1.25}

% Bold date
\newdateformat{mydate}{\textbf{\date}}

% Variables for liturgical season and week number
\newcommand{\litweeknum}[1]{\Ordinalstringnum{#1}}

% Weekly title
\newcommand\mytitle[1]{%
    \pgfkeys{#1}
    \title{%
    \textbf{\Large Organist, Cantor, Choir, Celebrant %\\[-0.5em]
    \MAROON{\cross}
    \large \MAROON{\litweeknum{\litweek}\ Sunday of \season}} \vspace{-2.8em}}
}

% Solemnity title
\newcommand\customtitle[1]{%
    \pgfkeys{#1}
    \title{%
    \textbf{\Large Organist, Cantor, Choir, Celebrant %\\[-0.5em]
    \MAROON{\cross}
    \large \MAROON{\solemnity}} \vspace{-2.8em}}
}

% Grey color for Mass parts to avoid clutter
\definecolor{gray}{gray}{0.7}
\newcommand{\gr}[1]{\textcolor{gray}{#1}}

% Maroon font, as in the Roman Missal
\definecolor{MAROON}{rgb}{0.7,0.13,0.13}  
%\newcommand{\MAROON}[1]{\textcolor{MAROON}{#1}}
\newcommand{\MAROON}[1]{\textcolor{red}{#1}}

% Cross symbol
\newcommand\cross{\item[\MAROON{\CrossMaltese}]}

% Hymn schedule
\pgfkeys{%
    litweek/.default = ,
    litweek/.store in = \litweek,
    season/.default = ,
    season/.store in = \season,
    solemnity/.default = ,
    solemnity/.store in = \solemnity,
    processional/.default = ,
    processional/.store in = \processional,
    psalm/.default = ,
    psalm/.store in = \psalm,
    gospelacc/.default = ,
    gospelacc/.store in = \ga,
    sequence/.default = ,
    sequence/.store in = \sequence,
    ashes/.default = ,
    ashes/.store in = \ashes,
    confirmation/.default = ,
    confirmation/.store in = \confirmation,
    feet/.default = ,
    feet/.store in = \feet,
    veneration/.default = ,
    veneration/.store in = \veneration,
    offertory/.default = ,
    offertory/.store in = \offertory,
    communion/.default = ,
    communion/.store in = \communion,
    meditation/.default = ,
    meditation/.store in = \meditation,
    recessional/.default = ,
    recessional/.store in = \recessional,
    transfer/.default = ,
    transfer/.store in = \transfer,
    setting/.default = ,
    setting/.store in = \setting,
    kyrie/.default = ,
    kyrie/.store in = \kyrie,
    sprinkling/.default = ,
    sprinkling/.store in = \sprinkling,
    gloria/.default = ,
    gloria/.store in = \gloria,
    holy/.default = ,
    holy/.store in = \sanctus,
    memacc/.default = ,
    memacc/.store in = \ma,
    amen/.default = ,
    amen/.store in = \amen,
    lambofgod/.default = ,
    lambofgod/.store in = \log,
    greyout/.default = ,
    greyout/.store in = \greyout,
    notes/.default = ,
    notes/.store in = \notes,
    litweek, season, solemnity, processional, psalm, gospelacc, sequence, ashes, 
    confirmation, feet, veneration, offertory, communion, meditation, recessional, 
    transfer, setting, kyrie, gloria, sprinkling, holy, memacc, amen, lambofgod,
    greyout, notes}

% ========================================================== %
% Notes
\newcommand\notesheader[1]{%
    \vspace{-1em} \noindent \small{\MAROON{#1}} \\[-0.5em]}

% Hymn list
\newcommand\hymns[2][]{%
\begingroup
\pgfkeys{#1}
\noindent\rule{\textwidth}{0.4pt} \\[1em]
\noindent\begin{tabular}{ll}
    
        \textbf{Processional:} \hspace{3cm} & \processional \\[1em]
        
        \ifx\kyrie\empty
            % Omit Kyrie if empty
        \else
            \ifx\greyout\empty
                \textbf{Kyrie} & \kyrie \\
            \else
                \gr{\textbf{Kyrie}} & \gr{\kyrie} \\
            \fi
        \fi
        \ifx\sprinkling\empty
            % Omit Sprinkling Rite if empty
        \else
            \textbf{Sprinkling Rite:} & \sprinkling \\
        \fi
        \ifx\gloria\empty
            % Omit Gloria if empty
        \else
            \ifx\greyout\empty
                \textbf{Gloria:} & \gloria \\[1em]
            \else
                \gr{\textbf{Gloria:}} & \gr{\gloria} \\[1em]
            \fi
        \fi

        \textbf{Responsorial Psalm:} & \psalm \\
        \ifx\sequence\empty
            % Omit Sequence if empty
        \else
            \textbf{Sequence} & \sequence \\
        \fi
        \textbf{Gospel Acclamation:} & \ga \\[1em]
        \ifx\ashes\empty
            % Omit Ashes if empty
        \else
            \textbf{Ashes} & \ashes \\[1em]
        \fi
        \ifx\confirmation\empty
            % Omit Confirmation if empty
        \else
            \textbf{Confirmation:} & \confirmation \\
        \fi
        \ifx\feet\empty
            % Omit Feet if empty, for Holy Thursday
        \else
            \textbf{Washing of Feet:} & \feet \\[1em]
        \fi
        \ifx\veneration\empty
            % Omit Veneration if empty, for Good Friday
        \else
            \textbf{Adoration of the Holy Cross:} & \veneration \\[1em]
        \fi
        \textbf{Preparation of Gifts:} & \offertory \\[1em]

        \ifx\greyout\empty
            \ifx\sanctus\empty
                % Omit Holy, Holy, Holy if empty
            \else
                \textbf{Holy, Holy, Holy:} & \sanctus \\
            \fi
            \ifx\ma\empty
                % Omit Memorial Acclamation if empty
            \else
                \textbf{Memorial Acclamation:} & \ma \\
            \fi
            \ifx\amen\empty
                % Omit Great Amen if empty
            \else
                \textbf{Great Amen:} & \amen \\
            \fi
            \ifx\log\empty
                % Omit Lamb of God if empty
            \else
                \textbf{Lamb of God:} & \log \\
            \fi
        \else
            \ifx\sanctus\empty
                % Omit Holy, Holy, Holy if empty
            \else            
                \gr{\textbf{Holy, Holy, Holy:}} & \gr{\sanctus} \\
            \fi
            \ifx\ma\empty
                % Omit Memorial Acclamation if empty
            \else
                \gr{\textbf{Memorial Acclamation:}} & \gr{\ma} \\
            \fi
            \ifx\amen\empty
                % Omit Great Amen if empty
            \else
                \gr{\textbf{Great Amen:}} & \gr{\amen} \\
            \fi
            \ifx\log\empty
                % Omit Lamb of God if empty
            \else
                \gr{\textbf{Lamb of God:}} & \gr{\log} \\
            \fi
        \fi

        \ifx\meditation\empty
            \textbf{Communion:} & \communion \\[1em]
            % Omit Meditation if empty
        \else
            \textbf{Communion:} & \communion \\
            \textbf{Meditation} & \meditation \\[1em]
        \fi
        \ifx\recessional\empty
            % Omit Recessional if empty
        \else
            \textbf{Recessional:} & \recessional \\ \\
        \fi
        \ifx\transfer\empty
            % Omit Transfer if empty, for Holy Thursday
        \else
            \textbf{Transfer of the Blessed Sacrament:} & \transfer \\ \\
        \fi

\end{tabular}
\endgroup}
